alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (
    msg:"THREAT-HUNT Cobalt Strike Beacon HTTP C2 Communication Detected";
    flow:to_server,established;
    content:"GET"; http_method;
    content:"/"; http_uri; depth:1;
    urilen:4; urilen:<200;
    pcre:"/^[a-z]{4,8}$/U";
    content:"Accept|3a|*|20 2a 2f 2a|"; http_header;
    content:"Referer|3a|"; http_header;
    content:"|Cookie|3a|"; http_header;
    threshold:type both, track by_src, count 3, seconds 60;
    classtype:trojan-activity;
    sid:1000001;
    rev:1;
    metadata:created_at 2025_11_06, updated_at 2025_11_06, attack_target Client_Endpoint, policy connectivity-ips;
    reference:url,blog.cobaltstrike.com/2013/12/11/a-look-at-cobalt-strikes-beacon-communication/;
)
